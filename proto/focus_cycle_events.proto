syntax = "proto3";

package focuswave.integration.events;

import "google/protobuf/duration.proto";
import "google/protobuf/timestamp.proto";
import "integration_event_base.proto";

message FocusCycleEvent {
  IntegrationEvent base = 1;
  string focusCycleId = 2;
  google.protobuf.Timestamp eventTime = 3;

  oneof event {
    StartWithDuration startWithDuration = 4;
    StartWithoutDuration startWithoutDuration = 5;
    EndEvent ended = 6;
  }

  oneof detail {
    FocusSessionDetail focusSession = 7;
    PlannedBreakDetail plannedBreak = 8;
    UnplannedInterruptionDetail unplannedInterruption = 9;
    FocusCycleDetail focusCycle = 10;
    FocusSessionTooShortDetail focusSessionTooShort = 11;
  }
}

message StartWithDuration {
  google.protobuf.Duration planned_duration = 1;
}

message StartWithoutDuration {
}

message EndEvent {
}

// detail messages — можно расширять
message FocusSessionDetail {
  int32 segment_index = 1;
}

message PlannedBreakDetail {
  int32 segment_index = 1;
}

message UnplannedInterruptionDetail {
  int32 segment_index = 1;
}

message FocusSessionTooShortDetail {
  int32 segment_index = 1;
}

message FocusCycleDetail {
  string userId = 1;
}
